<Window x:Class="PyWinInstall.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PyWinInstall"
        mc:Ignorable="d"
        Title="PyWinInstall - Python Environment Installer" Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title -->
        <TextBlock Grid.Row="0" Text="Python Environment Installer" 
                   FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" 
                   Margin="0,0,0,20"/>
        
        <!-- Python Installation Section -->
        <GroupBox Grid.Row="1" Header="Python Installation" Margin="0,0,0,15" x:Name="PythonGroupBox">
            <StackPanel Margin="10">
                <CheckBox x:Name="PythonAlreadyInstalledCheckBox" 
                          Content="Python already installed - skip installation" 
                          Margin="0,0,0,10"
                          Checked="PythonAlreadyInstalledCheckBox_Checked"
                          Unchecked="PythonAlreadyInstalledCheckBox_Unchecked"/>
                
                <Grid x:Name="PythonInstallGrid">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Python Version:" 
                               VerticalAlignment="Center" Margin="0,0,10,5"/>
                    <ComboBox Grid.Row="0" Grid.Column="1" x:Name="PythonVersionComboBox" 
                              Margin="0,0,10,5" SelectionChanged="PythonVersionComboBox_SelectionChanged">
                        <ComboBoxItem Content="3.12.6" IsSelected="True"/>
                        <ComboBoxItem Content="3.11.9"/>
                        <ComboBoxItem Content="3.10.11"/>
                        <ComboBoxItem Content="3.9.19"/>
                    </ComboBox>
                    <Button Grid.Row="0" Grid.Column="2" x:Name="InstallPythonButton" 
                            Content="Install Python" Click="InstallPythonButton_Click" 
                            Margin="0,0,0,5"/>
                    
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Install Path:" 
                               VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="PythonPathTextBox" 
                             Text="C:\Python" Margin="0,0,10,0"
                             TextChanged="PythonPathTextBox_TextChanged"/>
                    <Button Grid.Row="1" Grid.Column="2" Content="Browse..." 
                            Click="BrowsePythonPath_Click" x:Name="BrowsePythonPathButton"/>
                </Grid>
            </StackPanel>
        </GroupBox>
        
        <!-- Git Repository Section -->
        <GroupBox Grid.Row="2" Header="Git Repository" Margin="0,0,0,15">
            <StackPanel Margin="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Repository URL:" 
                               VerticalAlignment="Center" Margin="0,0,10,5"/>
                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="RepoUrlTextBox" 
                             Margin="0,0,10,5" 
                             Text="https://github.com/username/repository.git"
                             TextChanged="RepoUrlTextBox_TextChanged"/>
                    <Button Grid.Row="0" Grid.Column="2" x:Name="CloneRepoButton" 
                            Content="Clone Repository" Click="CloneRepoButton_Click" 
                            Margin="0,0,0,5"/>
                    
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Clone To:" 
                               VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="ClonePathTextBox" 
                             Text="C:\Projects" Margin="0,0,10,0"
                             TextChanged="ClonePathTextBox_TextChanged"/>
                    <Button Grid.Row="1" Grid.Column="2" Content="Browse..." 
                            Click="BrowseClonePath_Click"/>
                </Grid>
            </StackPanel>
        </GroupBox>
        
        <!-- PowerShell Script Section -->
        <GroupBox Grid.Row="3" Header="PowerShell Script" Margin="0,0,0,15">
            <StackPanel Margin="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="Script Path:" 
                               VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Column="1" x:Name="ScriptPathTextBox" 
                             Margin="0,0,10,0" 
                             Text="C:\Projects\install.ps1"
                             TextChanged="ScriptPathTextBox_TextChanged"/>
                    <Button Grid.Column="2" Content="Browse..." 
                            Click="BrowseScriptPath_Click" Margin="0,0,10,0"/>
                    <Button Grid.Column="3" x:Name="RunScriptButton" 
                            Content="Run Script" Click="RunScriptButton_Click"/>
                </Grid>
            </StackPanel>
        </GroupBox>
        
        <!-- Output Section -->
        <GroupBox Grid.Row="4" Header="Output" Margin="0,0,0,15">
            <ScrollViewer>
                <TextBox x:Name="OutputTextBox" 
                         IsReadOnly="True" 
                         TextWrapping="Wrap" 
                         FontFamily="Consolas"
                         Background="Black"
                         Foreground="White"
                         Margin="5"/>
            </ScrollViewer>
        </GroupBox>
        
        <!-- Progress and Actions -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right">
            <ProgressBar x:Name="ProgressBar" Width="200" Height="20" 
                         Margin="0,0,15,0" Visibility="Collapsed"/>
            <Button x:Name="InstallAllButton" Content="Install All" 
                    Click="InstallAllButton_Click" Padding="15,5" 
                    FontWeight="Bold"/>
        </StackPanel>
    </Grid>
</Window>
